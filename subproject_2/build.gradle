/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/7.0.2/samples
 */

task copyTask(type: CopyTask){
    from = files('from')
    to = layout.projectDirectory.dir('to')
}

class CopyTask extends DefaultTask{

    @InputFiles
    FileCollection from

    @OutputDirectory
    Directory to

    @TaskAction
    void execute(){
        File file = from.getSingleFile()
        if(file.isDirectory()){
            from.getAsFileTree().each {
                copyFileToDir(it, to)
            }
        }else{
            copyFileToDir(from, to)
        }
    }

    void copyFileToDir(File src, Directory dir){
        File dest = new File("${dir.getAsFile().path}/${src.name}")
        if(!dest.exists()){
            dest.createNewFile()
        }
        dest.withOutputStream {
            it.write(new FileInputStream(src).getBytes())
        }
    }
}
